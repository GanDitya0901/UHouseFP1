<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />
    <title>Manage Profile</title>
</head>
<body>
        <!--NavBar-->
        <nav class="navbar navbar-expand-lg" id="navbar">
            <div class="container">
              <script src="https://unpkg.com/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        
              <a class="navbar-brand" href="landing-page" id="logo"><img src="../../assets/Images/logoFix.png" alt="" width="90px"><span>U </span>House</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span><i class="fa-solid fa-bars"></i></span>    
              </button>
              <div class="collapse navbar-collapse justify-content-center" id="mynavbar">
                <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link " href="dashboardGuest">Home</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="dashboardGuest">Rooms</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link " href="dashboardGuest">Services</a>
                  </li>
                  
                 <!-- <li class="nav-item">
                    <a class="nav-link" (click)="scrollToContact()">Contact</a>
                  </li> -->
        
                  <li class="nav-item">
                    <a class="nav-link " href="dashboardGuest">About</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link active" href="/manage-profile">Manage Profile</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="javascript:void(0)" (click)="logout()">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <script src="path/to/jquery.min.js"></script>
          <script src="path/to/bootstrap.bundle.min.js"></script>
        <!--NavBar-->
        <div class="container">
            <div class="row flex-lg-nowrap">
              <div class="col">
                <div class="row">
                  <div class="col mb-3">
                    <div class="card">
                      <div class="card-body">
                        <div class="e-profile">
                          <div class="row">
                            <div class="col-12 col-sm-auto mb-3">
                              <div class="mx-auto" style="width: 140px">
                                <div
                                  class="d-flex justify-content-center align-items-center rounded"
                                  style="
                                    height: 140px;
                                    background-color: rgb(233, 236, 239);
                                  "
                                >
                                  <img
                                    [src]="
                                      temporaryPhotoUrl
                                        ? temporaryPhotoUrl
                                        : getFullImagePath(user.profilePhoto)
                                    "
                                    alt="Your Image"
                                    style="
                                      height: 100%;
                                      width: 100%;
                                      object-fit: cover;
                                    "
                                  />
                                </div>
                              </div>
                            </div>
                            <div
                              class="col d-flex flex-column flex-sm-row justify-content-between mb-3"
                            >
                              <div class="text-center text-sm-left mb-2 mb-sm-0">
                                <h4 class="pt-sm-2 pb-1 mb-0 text-nowrap">
                                  {{ user.fullname }}
                                </h4>
                                <p class="mb-0">@{{ user.username }}</p>
                                <div class="mt-2" style="background-color: #785025">
                                  <button
                                    class="btn btn-primary"
                                    type="button"
                                    (click)="triggerFileInput()"
                                    aria-label="Change Photo"
                                  >
                                  <i class="bi bi-person"></i>
                                                                <span>Change Photo</span>
                                  </button>
                                  <input
                                    type="file"
                                    id="fileInput"
                                    [hidden]="true"
                                    (change)="onPhotoChange($event)"
                                    accept="image/*"
                                  />
                                </div>
                              </div>
                              <div class="text-center text-sm-right">
                                <span class="badge badge-secondary">{{
                                  user.role
                                }}</span>
                                <div class="text-muted">
                                  <small
                                    >Joined
                                    {{ user.date | date : "shortDate" }}</small
                                  >
                                </div>
                              </div>
                            </div>
                          </div>
                          <ul class="nav nav-tabs">
                            <li class="nav-item">
                              <a href="" class=" nav-link">Manage Profile</a>
                            </li>
                          </ul>
                          <div class="tab-content pt-3">
                            <div class="tab-pane active">
                              <!-- Conditionally render profile details or edit form -->
                              <div *ngIf="!editing">
                                <div class="row">
                                  <div class="col-md-6">
                                    <p><strong>Full Name: </strong>{{ user.fullname }}</p>
                                  </div>
                                  <div class="col-md-6">
                                    <p><strong>Username: </strong>@{{ user.username }}</p>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6">
                                    <p><strong>Email: </strong>{{ user.email }}</p>
                                  </div>
                                  <div class="col-md-6">
                                    <p><strong>Phone Number: </strong>{{ user.phone }}</p>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6">
                                    <p><strong>Date of Birth: </strong>{{ user.dateOfBirth }}</p>
                                  </div>
                                  <div class="col-md-6">
                                    <p><strong>Gender: </strong>{{ user.gender }}</p>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6">
                                    <p><strong>Address: </strong>{{ user.address }}</p>
                                  </div>
                                  <div class="col-md-6">
                                    <p><strong>Country: </strong>{{ user.country }}</p>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6">
                                    <p><strong>Language: </strong>{{ user.language }}</p>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col d-flex justify-content-end">
                                    <button class="btn btn-primary" (click)="editing = true">Edit Profile</button>
                                  </div>
                                </div>
                              </div>
                              <form *ngIf="editing" class="form" (ngSubmit)="saveChanges()" novalidate>
                                <div class="row">
                                  <div class="col">
                                    <div class="row">
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Full Name</label>
                                          <input
                                            class="form-control"
                                            type="text"
                                            [(ngModel)]="user.fullname"
                                            name="fullname"
                                            placeholder="Jane Smith"
                                            required
                                          />
                                        </div>
                                      </div>
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Username</label>
                                          <input
                                            class="form-control"
                                            type="text"
                                            [(ngModel)]="user.username"
                                            name="username"
                                            placeholder="@jhenny.s"
                                            required
                                          />
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Email</label>
                                          <input
                                            class="form-control"
                                            type="email"
                                            [(ngModel)]="user.email"
                                            name="email"
                                            placeholder="jane.smith@mail.com"
                                            required
                                          />
                                        </div>
                                      </div>
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Phone Number</label>
                                          <input
                                            class="form-control"
                                            type="tel"
                                            [(ngModel)]="user.phone"
                                            name="phone"
                                            placeholder="Enter phone number"
                                          />
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Date of Birth</label>
                                          <input
                                            class="form-control"
                                            type="date"
                                            [(ngModel)]="user.dateOfBirth"
                                            name="dateOfBirth"
                                            required
                                          />
                                        </div>
                                      </div>
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Gender</label>
                                          <select
                                            class="form-control"
                                            [(ngModel)]="user.gender"
                                            name="gender"
                                          >
                                            <option value="male">Male</option>
                                            <option value="female">Female</option>
                                            <option value="other">Other</option>
                                          </select>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Address</label>
                                          <textarea
                                            class="form-control"
                                            rows="5"
                                            [(ngModel)]="user.address"
                                            name="address"
                                            placeholder="Gunung Andakasa St, Padangsambian, Bali"
                                            required
                                          ></textarea>
                                        </div>
                                      </div>
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label>Country</label>
                                          <input
                                            class="form-control"
                                            type="text"
                                            [(ngModel)]="user.country"
                                            name="country"
                                            placeholder="Enter your country"
                                          />
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-md-6">
                                        <div class="form-group">
                                          <label for="language">Language</label>
                                          <select
                                            class="form-control"
                                            id="language"
                                            [(ngModel)]="user.language"
                                            name="language"
                                          >
                                            <option value="en">English</option>
                                            <option value="id">Indonesian</option>
                                          </select>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row">
                                    <div class="col" style="left: 70%;">
                                        <button class="btn btn-primary" type="submit">Save Changes</button>
                                      </div>     
                                      <div class="col" style="left: 35%;">
                                        <button class="btn btn-secondary" type="button" (click)="editing = false">Close</button>
                                      </div>                                 
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Separate column for the password change card -->
                <div class="row">
                  <div class="col mb-3">
                    <div class="card">
                      <div class="card-body">
                        <!-- Separate form for changing password -->
                        <form class="form" (ngSubmit)="changePassword()" novalidate>
                          <div class="mb-2"><b>Change Password</b></div>
                          <div class="row">
                            <div class="col">
                              <div class="form-group">
                                <label>Current Password</label>
                                <input
                                  class="form-control"
                                  type="password"
                                  [(ngModel)]="currentPassword"
                                  name="currentPassword"
                                  placeholder="••••••"
                                  required
                                />
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <div class="form-group">
                                <label>New Password</label>
                                <input
                                  class="form-control"
                                  type="password"
                                  [(ngModel)]="newPassword"
                                  name="newPassword"
                                  placeholder="••••••"
                                  required
                                />
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <div class="form-group">
                                <label
                                  >Confirm
                                  <span class="d-none d-xl-inline"
                                    >Password</span
                                  ></label
                                >
                                <input
                                  class="form-control"
                                  type="password"
                                  [(ngModel)]="confirmPassword"
                                  name="confirmPassword"
                                  placeholder="••••••"
                                  required
                                />
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col d-flex justify-content-end">
                                <button class="btn btn-primary" type="submit">Change Password</button>
                            </div>
                            <div class="col-12" *ngIf="samePassMessage" class="danger-message text-danger text-lg-right" style="margin-top: 10px;">
                                <p>{{ samePassMessage }}</p>
                            </div> 
                            <div class="col-12" *ngIf="successMessage" class="success-message text-success text-lg-right" style="margin-top: 10px;">
                                <p>{{ successMessage }}</p>
                            </div>
                            <div class="col-12" *ngIf="errorMessage" class="danger-message text-danger text-lg-right" style="margin-top: 10px;">
                                <p>{{ errorMessage }}</p>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
          <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
